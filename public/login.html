<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=devce-width, initial-scale=1.0">
        <title>Login - SFSU Meets</title>
        <link rel="stylesheet" href="stylesheets/stylesheet.css">
        <link rel="stylesheet" href="stylesheets/login-stylesheet.css">
        <link rel="icon" href="images/GatorLogo_blk.png" type="image">
    </head>
    <body onload="checkLogin()">
        <header>
            <a href="index.html"><img src="images/headerImg.png" alt="Homepage Link" style="width: auto;height: 56px;"></a>
        </header>
        <nav id="navBar">
            <ul>
                <li><img class="logo" src="images/headerImg.png"></li>
                <li><a href="index.html">Home</a></li>
                <li class="dropdown">
                    <a class="dropbtn">Organizations ▾</a>
                    <div class="dropdown-content">
                        <a href="organizations.html">All Organizations</a>
                        <a href="createorganization.html">Create an Organization</a>
                    </div>
                </li>
                <li class="dropdown">
                    <a class="dropbtn">Events ▾</a>
                    <div class="dropdown-content">
                        <a href="events.html">All Events</a>
                        <a href="createevent.html">Create an Event</a>
                    </div>
                </li>
                <li class="dropdown">
                    <a class="dropbtn">Help ▾</a>
                    <div class="dropdown-content">
                        <a href="about.html">About</a>
                        <a href="faq.html">FAQ</a>
                        <a href="contact.html">Contact</a>
                    </div>
                </li>
                <li>
                    <form action="search.php" method="post">
                        <input type="text" name="search" placeholder="Search">
                        <button class="search" type="submit" name="submit-search"><img src="images/magnifyingglass.png" width="10"></button>
                    </form>
                </li>
                <li id="loginbuttons">
                    <form>
                        <button class="log" type="submit" formaction="login.html">Login</button>
                        <button class="reg" type="submit" formaction="signup.html">Sign Up</button>
                    </form>
                </li>
                <li class="dropdown" id="accountinfo">
                    <a class="dropbtn" id="name"></a>
                    <div class="dropdown-content">
                        <a href="account_page.html">Profile</a>
                        <a href="" id="logoutbutton" onclick="logout()">Logout</a>
                    </div>
            </ul>
            <script src="scripts/navbar.js"></script>
        </nav>
        <main>
            <form id="login_form">
            <div class="container">
                <h1>Login</h1>
                <p>Please enter your detail to login.</p>
                <hr>

                <div id="errorMsg" class="errorMsg">

                </div>
            
                <label for="email"><b>Email</b></label>
                <input type="email" placeholder="Enter Email" name="email_login" id="email_login" required>

                <label for="pass"><b>Password</b></label>
                <input type="password" placeholder="Enter Password" name="pass_login" id="pass_login" required>

                <button type="submit" class="login_button" id="login_button">Login</button>
                <hr>
                <p>Don't have an account? <a href="signup.html">Sign up!</a></p>
                
            </div>
            </form>
        </main>
        <br>
        <footer>
            <a href="index.html">Home</a>
            |
            <a href="about.html">About</a>
            |
            <a href="faq.html">FAQ</a>
            |
            <a href="contact.html">Contact</a>
            <br><br>
            <a href="https://github.com/CSC317-2023-Fall/csc317-group-project-website-ColeChiodo" target="_blank"><img src="images/github.svg" alt="github link"></a><br>
            <br>
            SFSU Meets<br>
            Window Group
        </footer>

        <script>
            const log_form = document.getElementById("login_form");
            const log_button = document.getElementById("login_button");
            const fade = document.querySelector('.errorMsg');
            

            log_button.addEventListener("click", (l) => {
                l.preventDefault();
                const log_email = log_form.email_login.value;
                const log_pass = log_form.pass_login.value;
                
                if(log_email === "admin" && log_pass === "admin"){
                    alert("You have log in as an admin!");
                    setCookie("email", log_email, 14);
                    setCookie("pass", log_pass, 14);
                    setCookie("fname", "Mighty", 14);
                    setCookie("lname", "Teapot", 14);
                    setCookie("idNum", "123456789", 14);
                    setCookie("club", "Guildwars 2", 14);
                    setCookie("loggedIn", true, 14);
                    location.replace("/account_page.html");
                }else{
                    document.getElementById("errorMsg").style.padding = "3px";
                    document.getElementById("errorMsg").style.border = "thin solid darkred";
                    document.getElementById("errorMsg").innerHTML = "<p>Invalid Login Credentials</p>";
                }
            })

            function setCookie(cname, cvalue, exdays){
                const exp = new Date();
                exp.setTime(exp.getTime() + (exdays*24*69*60*1000));
                let expires = "expires=" + exp.toUTCString();
                document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }

            function getCookies(cname){
                let name = cname + "=";
                let contentCookie = decodeURIComponent(document.cookie);
                let ca = contentCookie.split(';');
                for(let i = 0; i < ca.length; i++){
                    let c = ca[i];
                    while (c.charAt(0) == ' '){
                        c = c.substring(1);    
                    }
                    if(c.indexOf(name) == 0){
                    return c.substring(name.length, c.length);
                    }
                }
                return "";
            }

            function checkLogin(){
                let logged = getCookies("loggedIn");
                if(logged === "true"){
                    alert("You have already logged in");
                    location.replace("/account_page.html");
                }
            }


        </script>
        
    </body>
</html>
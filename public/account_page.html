<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=devce-width, initial-scale=1.0">
        <title>UserName - SFSU Meets</title>
        <link rel="stylesheet" href="stylesheets/stylesheet.css">
        <link rel="stylesheet" href="stylesheets/account-stylesheet.css">
        <link rel="icon" href="images/GatorLogo_blk.png" type="image">

    </head>
    <body onload="getInfo()">
        <header>
            <br>
        </header>
        <nav id="navBar">
            <ul>
                <li><img class="logo" src="images/headerImg.png"></li>
                <li><a href="index.html">Home</a></li>
                <li class="dropdown">
                    <a class="dropbtn">Organizations ▾</a>
                    <div class="dropdown-content">
                        <a href="organizations.html">All Organizations</a>
                        <a href="createorganization.html">Create an Organization</a>
                    </div>
                </li>
                <li class="dropdown">
                    <a class="dropbtn">Events ▾</a>
                    <div class="dropdown-content">
                        <a href="events.html">All Events</a>
                        <a href="createevent.html">Create an Event</a>
                    </div>
                </li>
                <li class="dropdown">
                    <a class="dropbtn">Help ▾</a>
                    <div class="dropdown-content">
                        <a href="about.html">About</a>
                        <a href="faq.html">FAQ</a>
                        <a href="contact.html">Contact</a>
                    </div>
                </li>
                <li>
                    <form action="search.php" method="post">
                        <input type="text" name="search" placeholder="Search">
                        <button class="search" type="submit" name="submit-search"><img src="images/magnifyingglass.png" width="10"></button>
                    </form>
                </li>
                <li id="loginbuttons">
                    <form>
                        <button class="log" type="submit" formaction="login.html">Login</button>
                        <button class="reg" type="submit" formaction="signup.html">Sign Up</button>
                    </form>
                </li>
                <li class="dropdown" id="accountinfo">
                    <a class="dropbtn" id="name"></a>
                    <div class="dropdown-content">
                        <a href="account_page.html">Profile</a>
                        <a href="" id="logoutbutton" onclick="logout()">Logout</a>
                    </div>
            </ul>
            <script src="scripts/navbar.js"></script>
        </nav>
        <main>
            <div class="grid-container">
            <div class="item1" id="menu">
                <a href="#personal_info">Personal Infomation</a>
                <hr>
                <a href="#affiliated_info">Affiliated</a>
                <hr>
            </div>
            <div class="item2" id="personal_info"><h3>Personal Infomation  <button class="edit_info" type="submit" id="edit_info" onclick="show_save()">Edit</button></h3>
                <br>
                <img src="images/headerBackground.jpg" alt="avatar icon" width="20%" height="auto">
                <br>
                <button class="edit_pic" type="button" id="edit_pic">Change Picture</button>
                <br>
                <label for="bio"><b>Description</b></label>
                <input type="text" placeholder="Enter a quick description about yourself" name="bio" id="bio">
                <hr>
                <div id="fname">
                    <p><b>First Name:</b></p>
                </div>
                <hr>
                <div id="lname">
                    <p><b>Last Name:</b></p>
                </div>
                <hr>
                <div id="idNum">
                    <p><b>SFSU ID:</b></p>
                </div>
                <hr>
                <div id="email">
                    <p><b>Email:</b></p>
                </div>
                <hr>
                <div id="pass">  
                    <p><b>Password:</b></p>
                </div> 
                <hr>
                <div id="save">
                    <button type="submit" class="save_but" id="save_but">Save</button>
                </div>  
            </div>
            <div class="item3" id="affiliated_info"><h3>Affiliated</h3>
                <br>
                <p><b>Club 1:</b></p>
                
            </div>
            </div>
        </main>
        <footer>
            <a href="index.html">Home</a>
            |
            <a href="about.html">About</a>
            |
            <a href="faq.html">FAQ</a>
            |
            <a href="contact.html">Contact</a>
            <br><br>
            <a href="https://github.com/CSC317-2023-Fall/csc317-group-project-website-ColeChiodo" target="_blank"><img src="images/github.svg" alt="github link"></a><br>
            <br>
            SFSU Meets<br>
            Window Group
        </footer>
        <script>
            function setCookie(cname, cvalue, exdays){
                const exp = new Date();
                exp.setTime(exp.getTime() + (exdays*24*69*60*1000));
                let expires = "expires=" + exp.toUTCString();
                document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }

            function getCookies(cname){
                let name = cname + "=";
                let contentCookie = decodeURIComponent(document.cookie);
                let ca = contentCookie.split(';');
                for(let i = 0; i < ca.length; i++){
                    let c = ca[i];
                    while (c.charAt(0) == ' '){
                        c = c.substring(1);    
                    }
                    if(c.indexOf(name) == 0){
                    return c.substring(name.length, c.length);
                    }
                }
                return "";
            }

            function getInfo(){
                const fname = getCookies("fname");
                const lname = getCookies("lname");
                const idNum = getCookies("idNum");
                const email = getCookies("email");
                const pass = getCookies("pass");
                const club = getCookies("club");
                const loginbuttons = document.getElementById("loginbuttons");
                document.getElementById("fname").innerHTML += "<p id='change_f'>" + fname + "</p>";
                document.getElementById("lname").innerHTML += "<p id='change_l'>" + lname + "</p>";
                document.getElementById("idNum").innerHTML += "<p id='change_n'>" + idNum + "</p>";
                document.getElementById("email").innerHTML += "<p id='change_e'>" +email + "</p>";
                document.getElementById("pass").innerHTML += "<p id='change_p'>" + pass + "</p>";
                document.getElementById("affiliated_info").innerHTML += "<p>" + club + "</p><hr>";

                var navbar = document.getElementById("navBar");
                var sticky = navbar.offsetTop;

                let logged = getCookies("loggedIn");
                if(logged === "true"){
                    loginbuttons.remove();
                    let name = fname + " " + lname + " ▾";
                    document.getElementById("name").innerHTML = name;
                    sticky = navbar.offsetTop;
                }
                else{
                    accountinfo.remove();
                }
            }

            function logout(){
                document.cookie = "fname=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "lname=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "idNum=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "email=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "pass=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "club=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "loggedIn=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";

                alert("You have been logged out!");
                window.location.href = ".";
            }

            const edit_info = document.getElementById("edit_info");
            const edit_pic = document.getElementById("edit_pic");
            const save_but = document.getElementById("save_but")


            function show_save(){
                document.getElementById("save_but").style.opacity = "0.9";
                document.getElementById("change_f").contentEditable = "true";
                document.getElementById("change_f").style.background = "#f1f1f1";
                document.getElementById("change_f").style.padding = "8px";
                document.getElementById("change_l").contentEditable = "true";
                document.getElementById("change_l").style.background = "#f1f1f1";
                document.getElementById("change_l").style.padding = "8px";
                document.getElementById("change_n").contentEditable = "true";
                document.getElementById("change_n").style.background = "#f1f1f1";
                document.getElementById("change_n").style.padding = "8px";
                document.getElementById("change_e").contentEditable = "true";
                document.getElementById("change_e").style.background = "#f1f1f1";
                document.getElementById("change_e").style.padding = "8px";
                document.getElementById("change_p").contentEditable = "true";
                document.getElementById("change_p").style.background = "#f1f1f1";
                document.getElementById("change_p").style.padding = "8px";
                
            }

            function save_info(){
                document.getElementById("save_but").style.opacity = "0";
                document.getElementById("change_f").contentEditable = "false";
                document.getElementById("change_f").style.background = "white";
                document.getElementById("change_f").style.padding = "0px";
                document.getElementById("change_l").contentEditable = "false";
                document.getElementById("change_l").style.background = "white";
                document.getElementById("change_l").style.padding = "0px";
                document.getElementById("change_n").contentEditable = "false";
                document.getElementById("change_n").style.background = "white";
                document.getElementById("change_n").style.padding = "0px";
                document.getElementById("change_e").contentEditable = "false";
                document.getElementById("change_e").style.background = "white";
                document.getElementById("change_e").style.padding = "0px";
                document.getElementById("change_p").contentEditable = "false";
                document.getElementById("change_p").style.background = "white";
                document.getElementById("change_p").style.padding = "0px";
            }

            save_but.addEventListener("click", (sa) => {
                sa.preventDefault();
                const ele = document.getElementById("save_but");
                const css = window.getComputedStyle(ele, null);
                let opac = css.getPropertyValue("opacity");
                
                if(opac === "0.9"){
                    save_info();
                    const fname = document.getElementById("change_f").innerHTML;
                    const lname = document.getElementById("change_l").innerHTML;
                    const idNum = document.getElementById("change_n").innerHTML;
                    const email = document.getElementById("change_e").innerHTML;
                    const pass = document.getElementById("change_p").innerHTML;
                    document.cookie = "fname=" + fname + "; path=/"; 
                    document.cookie = "lname=" + lname + "; path=/"; 
                    document.cookie = "idNum=" + idNum + "; path=/"; 
                    document.cookie = "email" + email + "; path=/"; 
                    document.cookie = "pass=" + pass + "; path=/"; 
                    location.reload();
                }else{
                    return ' ';
                }
            })

        </script>
    </body>
</html>